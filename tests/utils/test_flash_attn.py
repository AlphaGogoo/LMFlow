from __future__ import absolute_import
import unittest
import json
import os
from pathlib import Path

import torch
from transformers.deepspeed import HfDeepSpeedConfig

from lmflow.args import DatasetArguments, ModelArguments
from lmflow.datasets.dataset import Dataset
from lmflow.models.hf_decoder_model import HFDecoderModel
from lmflow.utils.constants import (
    TEXT_ONLY_DATASET_DESCRIPTION,
    TEXT2TEXT_DATASET_DESCRIPTION,
)


model_name = '/home/yizhenjia/projs/llama/llama-2-7b-chat-hf'


class FlashAttentionTest(unittest.TestCase):
    pass


data_args = DatasetArguments(dataset_path=None)
dataset = Dataset(data_args, backend="huggingface")
# dataset = dataset.from_dict(groundtruth_dataset)


model_args = ModelArguments(
    model_name_or_path=model_name, 
    use_flash_attention=True
)

from lmflow.models.auto_model import AutoModel
model = AutoModel.get_model(
    model_args,
    tune_strategy='none',
    use_accelerator=True,
)

inputs = model.encode(['''         {
            "from": "human",
            "value": "Je dois ajouter des éléments de gamification pour faire apprendre à des patients en hôpital ayant l'ostéoporose comment vivre avec la maladie et leur faire apprendre des choses"
         },
         {
            "from": "gpt",
            "value": "La gamification est un excellent moyen d'encourager les patients à apprendre et à s'engager dans le processus de gestion de leur maladie. Voici quelques idées pour ajouter des éléments de gamification à un programme d'éducation pour les patients atteints d'ostéoporose :\n\n1. Objectifs et récompenses : Définissez des objectifs clairs et atteignables pour les patients, comme apprendre de nouvelles informations, effectuer des exercices, ou suivre un régime alimentaire spécifique. Récompensez-les par des points, des badges, ou des niveaux pour chaque objectif atteint.\n2. Quiz interactifs : Créez des quiz amusants et interactifs pour tester les connaissances des patients sur l'ostéoporose, les traitements disponibles, et les bonnes habitudes de vie. Les patients peuvent gagner des points pour chaque bonne réponse et suivre leurs progrès au fil du temps.\n3. Jeux de rôle : Mettez en place des jeux de rôle où les patients peuvent pratiquer des situations de la vie réelle, comme demander de l'aide pour soulever des objets lourds, s'adresser à un professionnel de santé, ou gérer des situations d'urgence liées à l'ostéoporose.\n4. Défis quotidiens : Proposez des défis quotidiens aux patients pour les encourager à adopter des comportements sains, tels que marcher un certain nombre de pas, boire suffisamment d'eau, ou pratiquer des exercices de renforcement musculaire. Les patients peuvent suivre leurs progrès et gagner des points pour chaque défi réussi.\n5. Tableau de classement : Créez un tableau de classement où les patients peuvent comparer leurs progrès avec ceux des autres participants. Cela encourage la compétition amicale et motive les patients à continuer à apprendre et à s'améliorer.\n6. Réalité augmentée ou virtuelle : Utilisez des technologies de réalité augmentée ou virtuelle pour aider les patients à explorer et à comprendre leur corps et l'ostéoporose de manière immersive et interactive.\n7. Communauté en ligne : Créez une plateforme en ligne où les patients peuvent partager leurs expériences, poser des questions, et échanger des conseils avec d'autres personnes atteintes d'ostéoporose. Cela favorise l'entraide et la motivation mutuelle.\n8. Suivi des progrès : Permettez aux patients de suivre leurs progrès, tels que l'amélioration de leur densité osseuse, la réduction de la douleur, ou l'augmentation de leur mobilité. Les patients peuvent ainsi visualiser l'impact de leurs efforts et rester motivés.\n\nN'oubliez pas de rendre le programme d'éducation accessible et attrayant pour les patients de tous âges et de tous niveaux de compétence. Adaptez les activités et les supports pédagogiques en fonction des besoins individuels et assurez-vous de fournir un soutien et des encouragements continus tout au long du processus d'apprentissage."
         },
         {
            "from": "human",
            "value": "Contexte L’ostéoporose touche 5 millions de patients en France. Elle se définit comme une fragilité́ osseuse, survenant en majorité́ chez des personnes de plus de 60 ans, responsable de fractures itératives (377000 par an en France) aboutissant a l’entrée en dépendance et en institution. Pourtant, nous disposons de traitements efficaces permettant d’éviter la récidive de fractures, en particulier vertébrales et du col fémoral. Ces traitements sont longs, difficiles a suivre et nécessitent un long moment d’explication et de dialogue avec les patients pour aboutir a une réelle adhésion au suivi du traitement médicamenteux et aux changements de mode de vie imposés par la maladie. L’éducation thérapeutique du patient (ETP), telle que définie par l’Haute Autorité de Santé (HAS), permet de pallier ces difficultés. Les patients sont réunis avec divers intervenants (rhumatologue, pharmacien, diététicien, coach sportif), lors de séances successives, pour dialoguer sur leurs représentations de la maladie. Ces séances ont un double objectif : d’une part d’aboutir a une alliance thérapeutique entre le patient et les médecins de façon a éviter l’arrêt intempestif du traitement (qui concerne 50% des patients au bout d’un an) ; d’autre part l’adoption des changements du mode de vie en ce qui concerne l’alimentation, l’activité physique et l’équilibre au sol. Les programmes d’ETP mobilisent actuellement des schémas explicatifs figés et des animations non interactives qui ne répondent pas toujours a toutes les questions des patients et restent très abstraits pour un grand nombre d’entre eux. Dans ce contexte, il parait pertinent d’explorer l’apport de systèmes interactifs ou d’interface numérique permettant de faciliter l’apprentissage l’appropriation de comportements favorables a la santé des patients porteurs d’ostéoporose dans le cadre des ETP. De nombreux travaux montrent le potentiel de l’utilisation de jeux ou d’éléments de jeux dans les situations d’apprentissage [2,7] et sur la motivation [6]. L’introduction de ces éléments de jeux dans les systèmes interactifs est appelée gamification [3]. La mise en place des éléments de gamification à destination d’un publique cible repose sur une réflexion approfondie concernant les Interactions Humain-Machine (IHM) [1,4]. Sujet Dans un premier temps, le binôme devra réaliser un état de l’art des recherches sur la gamification en lien avec les IHM [8]. Puis, dans un second temps, il devra réaliser l’implémentation d’un prototype de jeu prenant en compte les leviers de la gamification les plus pertinents [5] dans le contexte de l’éducation thérapeutique du patient atteint d’ostéoporose. Le choix de la plateforme de développement parmi celles proposées (Xperia Touch, table interactive…) devra être justifié."
         },
         {
            "from": "gpt",
            "value": "L'étude de la gamification et des IHM (Interactions Humain-Machine) pour les patients atteints d'ostéoporose dans le cadre de l'éducation thérapeutique du patient (ETP) peut être structurée en plusieurs étapes :\n\n1. État de l'art : Recherchez et analysez les publications et études existantes sur la gamification, les IHM et leur utilisation dans le contexte de l'éducation thérapeutique du patient. Cela inclut également l'examen des applications et des jeux déjà existants, ainsi que des méthodes d'apprentissage en ligne et hors ligne.\n2. Identification des besoins des patients : Évaluez les besoins spécifiques des patients atteints d'ostéoporose en termes d'information, de soutien et de motivation. Il est essentiel de comprendre les défis auxquels les patients sont confrontés pour concevoir un prototype de jeu pertinent et efficace.\n3. Sélection des leviers de gamification : Identifiez les éléments de gamification les plus pertinents pour favoriser l'apprentissage et la motivation des patients atteints d'ostéoporose. Cela peut inclure des objectifs, des récompenses, des défis, des tableaux de classement, des éléments de réalité augmentée ou virtuelle, et des interactions sociales.\n4. Conception de l'IHM : Concevez une interface utilisateur intuitive et attrayante pour le jeu, en tenant compte des besoins et des préférences des patients atteints d'ostéoporose. Il est important d'assurer l'accessibilité et l'adaptabilité de l'interface pour les patients de tous âges et de tous niveaux de compétence.\n5. Choix de la plateforme de développement : Justifiez le choix de la plateforme de développement (Xperia Touch, table interactive, etc.) en fonction des besoins et des contraintes du projet. Considérez également les avantages et les inconvénients de chaque plateforme en termes de coût, de flexibilité, de compatibilité et d'interopérabilité.\n6. Développement du prototype : Développez un prototype de jeu interactif basé sur les leviers de gamification identifiés et la plateforme de développement choisie. Intégrez les fonctionnalités et les éléments de l'IHM conçus précédemment.\n7. Test et évaluation : Testez le prototype avec un groupe de patients atteints d'ostéoporose et évaluez son efficacité en termes d'apprentissage, de motivation et de satisfaction. Recueillez les commentaires des patients et des professionnels de santé impliqués dans l'ETP pour améliorer et affiner le prototype.\n8. Itérations et améliorations : Apportez les modifications nécessaires au prototype en fonction des commentaires et des résultats des tests. Répétez le processus de test et d'évaluation jusqu'à ce que le jeu réponde aux attentes et aux besoins des patients et des professionnels de santé.\n9. Documentation et présentation : Rédigez un rapport détaillé sur le projet, incluant l'état de l'art, la méthodologie, les résultats des tests et les recommandations pour des développements futurs. Présentez le projet à un public cible, tel que des professionnels de santé, des chercheurs et des patients, pour promouvoir et diffuser le"
         },
         {
            "from": "human",
            "value": "continue"
         },
         {
            "from": "gpt",
            "value": "jeu interactif développé.\n\n1. Diffusion et déploiement : Envisagez de collaborer avec des hôpitaux, des cliniques et des centres de rééducation pour intégrer le jeu interactif dans leurs programmes d'éducation thérapeutique du patient. Cela permettra aux patients atteints d'ostéoporose de bénéficier directement du jeu et de l'utiliser pour apprendre à gérer leur maladie.\n2. Suivi et mise à jour : Assurez un suivi régulier de l'utilisation et de l'efficacité du jeu auprès des patients et des professionnels de santé. Recueillez des données sur les progrès des patients, les taux d'adhésion au traitement et les changements de mode de vie. Utilisez ces informations pour apporter des améliorations et des mises à jour au jeu, en fonction des besoins et des retours d'expérience.\n\nEn suivant ces étapes, vous pourrez développer un prototype de jeu interactif qui aidera les patients atteints d'ostéoporose à mieux comprendre et gérer leur maladie dans le cadre de l'éducation thérapeutique du patient. La gamification et les IHM bien conçues peuvent jouer un rôle crucial pour motiver et soutenir ces patients tout au long de leur parcours de soins."
         },
         {
            "from": "human",
            "value": "Fait la première étape"
         },
         {
            "from": "gpt",
            "value": "Étape 1 : État de l'art\n\nVoici un état de l'art des recherches sur la gamification, les IHM et leur utilisation dans le contexte de l'éducation thérapeutique du patient, en particulier pour les patients atteints d'ostéoporose :\n\nA. Gamification dans l'éducation thérapeutique du patient :\n\n1. Deterding, S., Dixon, D., Khaled, R., & Nacke, L. (2011). From game design elements to gamefulness: Defining \"gamification\". Proceedings of the 15th International Academic MindTrek Conference: Envisioning Future Media Environments - MindTrek '11.\n2. Johnson, D., Deterding, S., Kuhn, K. A., Staneva, A., Stoyanov, S., & Hides, L. (2016). Gamification for health and wellbeing: A systematic review of the literature. Internet Interventions, 6, 89-106.\n\nB. Interactions Humain-Machine (IHM) dans l'éducation thérapeutique du patient :\n3. Bødker, S. (2006). When second wave HCI meets third wave challenges. Proceedings of the 4th Nordic conference on Human-computer interaction: Changing roles - NordiCHI '06.\n\n1. Norman, D. A. (2002). The Design of Everyday Things. Basic Books.\n\nC. Gamification et IHM pour les patients atteints d'ostéoporose :\n5. Oliveira, A. C., Mattos, M. K., & Rodrigues, R. C. (2018). Evaluation of a serious game to support the therapeutic education of patients with rheumatoid arthritis: A pilot study. Studies in Health Technology and Informatics, 247, 103-107.\n\n1. Rodrigues, R. C., Oliveira, A. C., & Vilela, R. A. (2016). The development of a serious game to support therapeutic education of patients with rheumatoid arthritis. Studies in Health Technology and Informatics, 221, 76-79.\n\nD. Autres études pertinentes sur la gamification et l'éducation thérapeutique du patient :\n7. Faiola, A., & Newlon, C. (2013). Advancing critical care medicine with persuasive, user-centered design: Using a gamification model. Proceedings of the International Conference on Human-Computer Interaction with Mobile Devices and Services - MobileHCI '13.\n\n1. Lister, C., West, J. H., Cannon, B., Sax, T., & Brodegard, D. (2014). Just a fad? Gamification in health and fitness apps. JMIR Serious Games, 2(2), e9.\n\nEn examinant ces études, vous pourrez avoir une vue d'ensemble des recherches sur la gamification et les IHM appliquées à l'éducation thérapeutique du patient. Cela vous permettra de mieux comprendre les défis et les opportunités liés à l'utilisation de la gamification et des IHM pour les patients atteints d'ostéoporose et d'identifier les éléments clés à considérer dans le développement d'un prototype de jeu interactif pour cette population spécifique."
         },
         {
            "from": "human",
            "value": "Examine ces études"
         },
         {
            "from": "gpt",
            "value": "Après avoir examiné les études mentionnées précédemment, voici un résumé des points clés et des enseignements tirés qui pourraient être pertinents pour le développement d'un jeu interactif destiné aux patients atteints d'ostéoporose dans le cadre de l'éducation thérapeutique du patient (ETP) :\n\n1. La gamification peut être définie comme l'utilisation d'éléments de conception de jeux dans des contextes non ludiques pour favoriser l'engagement, la motivation et le comportement souhaité [1]. Les éléments de gamification couramment utilisés incluent les objectifs, les récompenses, les défis, les tableaux de classement et les éléments de réalité augmentée ou virtuelle.\n2. Les recherches montrent que la gamification peut avoir un impact positif sur la santé et le bien-être, notamment en améliorant l'adhésion au traitement, la gestion de la douleur, la réadaptation et l'éducation des patients [2].\n3. Les IHM jouent un rôle crucial dans la conception d'applications et de jeux pour l'éducation thérapeutique du patient. Une interface utilisateur bien conçue et intuitive peut améliorer l'engagement et la satisfaction des patients, ainsi que faciliter l'apprentissage et la rétention des informations [3, 4].\n4. Les études sur la gamification et l'IHM pour les patients atteints de maladies similaires à l'ostéoporose, comme la polyarthrite rhumatoïde, montrent que les jeux sérieux peuvent aider à soutenir l'éducation thérapeutique et à améliorer la compréhension des patients sur leur maladie, leurs traitements et les changements de mode de vie nécessaires [5, 6].\n5. Pour que la gamification soit efficace dans l'éducation thérapeutique du patient, il est important de prendre en compte les besoins et les préférences des patients, ainsi que les objectifs spécifiques du traitement et de l'éducation [7, 8]. Par exemple, pour les patients atteints d'ostéoporose, il peut être important de mettre l'accent sur l'amélioration de l'alimentation, de l'activité physique et de l'équilibre.\n\nEn tenant compte de ces points clés et des enseignements tirés des études examinées, vous pouvez développer un jeu interactif qui utilise efficacement la gamification et les IHM pour soutenir l'éducation thérapeutique des patients atteints d'ostéoporose. Lors de la conception et du développement du jeu, il est essentiel de garder à l'esprit les besoins spécifiques des patients atteints d'ostéoporose et d'adapter les éléments de gamification et l'IHM en conséquence pour assurer une expérience utilisateur optimale."
         },
         {
            "from": "human",
            "value": "Va dans le détail dans l'analyse des études"
         },
         {
            "from": "gpt",
            "value": "Voici une analyse plus détaillée des études mentionnées précédemment, mettant en évidence des éléments importants qui peuvent être pertinents pour le développement d'un jeu interactif destiné aux patients atteints d'ostéoporose dans le cadre de l'éducation thérapeutique du patient :\n\nA. Gamification dans l'éducation thérapeutique du patient :\n\n1. Deterding et al. (2011) : Cette étude propose une définition de la gamification et présente un cadre conceptuel pour comprendre les éléments de conception de jeux et leur application dans des contextes non ludiques. Les auteurs identifient plusieurs éléments clés de la gamification, tels que les points, les badges, les classements et les défis. Ils soulignent également l'importance d'équilibrer ces éléments pour créer une expérience de jeu engageante et motivante.\n2. Johnson et al. (2016) : Cette revue systématique examine l'efficacité de la gamification dans les interventions de santé et de bien-être. Les auteurs constatent que la gamification peut améliorer l'adhésion au traitement, l'autogestion et les résultats en matière de santé, en particulier lorsque les éléments de jeu sont bien adaptés aux besoins et aux préférences des utilisateurs. Ils recommandent de mener des recherches supplémentaires pour déterminer les mécanismes spécifiques de la gamification qui contribuent à ces améliorations.\n\nB. Interactions Humain-Machine (IHM) dans l'éducation thérapeutique du patient :\n\n1. Bødker (2006) : Cette étude aborde les défis et les opportunités liés à l'intégration des IHM dans le domaine de la santé. L'auteur identifie plusieurs domaines clés dans lesquels les IHM peuvent avoir un impact, tels que la facilité d'utilisation, l'accessibilité et la personnalisation. Il souligne également l'importance de la recherche centrée sur l'utilisateur pour comprendre et répondre aux besoins des patients et des professionnels de la santé.\n2. Norman (2002) : Cet ouvrage classique sur la conception des interfaces utilisateur met en évidence les principes fondamentaux de la conception centrée sur l'utilisateur, tels que l'utilisabilité, l'affordance et la rétroaction. Il fournit des conseils pratiques pour créer des interfaces utilisateur efficaces et intuitives qui répondent aux besoins et aux attentes des utilisateurs.\n\nC. Gamification et IHM pour les patients atteints d'ostéoporose :\n\n1. Oliveira et al. (2018) : Cette étude pilote évalue un jeu sérieux destiné à soutenir l'éducation thérapeutique des patients atteints de polyarthrite rhumatoïde, une maladie présentant des similitudes avec l'ostéoporose. Les résultats montrent que les patients qui ont utilisé le jeu ont amélioré leurs connaissances sur la maladie et ses traitements, ainsi que leur engagement dans l'autogestion de leur maladie. Les auteurs suggèrent que des études supplémentaires sont nécessaires pour déterminer les facteurs spécifiques du jeu qui ont contribué à ces améliorations.\n2. Rodrigues et al. (2016) : Cette étude décrit le développement d'un jeu sérieux pour sout"
         },
         {
            "from": "human",
            "value": "continue"
         },
         {
            "from": "gpt",
            "value": "enir l'éducation thérapeutique des patients atteints de polyarthrite rhumatoïde. Les auteurs soulignent l'importance d'une conception centrée sur l'utilisateur et d'une collaboration étroite avec les patients et les professionnels de la santé pour garantir que le jeu répond aux besoins et aux préférences des utilisateurs. Ils identifient également plusieurs éléments clés de la gamification qui peuvent être pertinents pour les patients atteints d'ostéoporose, tels que la réalité augmentée, les défis adaptatifs et les systèmes de récompense.\n\nD. Autres études pertinentes sur la gamification et l'éducation thérapeutique du patient :\n\n1. Faiola et Newlon (2013) : Cette étude examine l'utilisation de la gamification pour améliorer la motivation et l'engagement des patients dans les soins intensifs. Les auteurs constatent que l'introduction d'éléments de jeu dans les interventions de santé peut favoriser l'adhésion au traitement, l'autogestion et la satisfaction des patients. Ils recommandent d'explorer davantage le potentiel de la gamification dans diverses populations de patients et de contextes de soins de santé.\n2. Lister et al. (2014) : Cette étude examine l'utilisation de la gamification dans les applications de santé et de fitness, en se concentrant sur les facteurs qui influencent l'adoption et l'utilisation continue de ces applications par les utilisateurs. Les auteurs constatent que la gamification peut améliorer l'engagement et la motivation des utilisateurs, mais que son efficacité dépend de la qualité de la conception et de l'adaptation aux besoins et aux préférences des utilisateurs.\n\nEn résumé, ces études mettent en évidence l'importance d'une conception centrée sur l'utilisateur et d'une collaboration étroite avec les patients et les professionnels de la santé lors de la création d'un jeu interactif pour soutenir l'éducation thérapeutique des patients atteints d'ostéoporose. Il est essentiel d'adapter les éléments de gamification et les IHM aux besoins spécifiques des patients atteints d'ostéoporose et d'évaluer l'efficacité du jeu dans l'amélioration de l'engagement, de la motivation et des résultats en matière de santé."
         },
         {
            "from": "human",
            "value": "Les jeux sérieux seront ils utiles à mon étude ? Si oui donne moi un jeu sérieux à analyser"
         },
         {
            "from": "gpt",
            "value": "Oui, les jeux sérieux peuvent être très utiles pour votre étude, car ils sont conçus pour combiner des objectifs d'éducation ou de formation avec des éléments de jeu engageants et motivants. Les jeux sérieux ont été utilisés avec succès dans divers contextes de santé pour améliorer l'éducation des patients, l'adhésion au traitement et l'autogestion de la maladie. En étudiant un jeu sérieux pertinent, vous pouvez obtenir des idées et des meilleures pratiques pour le développement de votre propre jeu interactif destiné aux patients atteints d'ostéoporose dans le cadre de l'éducation thérapeutique du patient.\n\nUn exemple de jeu sérieux à analyser est \"Re-Mission\" développé par HopeLab. Re-Mission est un jeu vidéo conçu pour aider les adolescents et les jeunes adultes atteints de cancer à comprendre leur maladie, les traitements disponibles et les comportements d'autogestion nécessaires pour améliorer leurs résultats en matière de santé.\n\nVoici quelques éléments clés de Re-Mission qui pourraient être pertinents pour votre étude :\n\n1. Objectifs éducatifs : Re-Mission vise à enseigner aux joueurs les mécanismes du cancer, les traitements standard (chimiothérapie, radiothérapie, etc.) et l'importance de l'adhésion au traitement. Bien que l'ostéoporose et le cancer soient des maladies différentes, l'approche de Re-Mission pour éduquer les joueurs sur leur maladie et les traitements disponibles pourrait être adaptée au contexte de l'ostéoporose.\n2. Engagement et motivation : Re-Mission utilise des éléments de gamification tels que des missions, des défis, des récompenses et des tableaux de classement pour encourager les joueurs à s'engager activement dans le jeu et à acquérir de nouvelles connaissances et compétences.\n3. Conception centrée sur l'utilisateur : Re-Mission a été développé en collaboration avec des patients atteints de cancer, des médecins, des psychologues et des concepteurs de jeux pour s'assurer que le jeu répond aux besoins et aux préférences des utilisateurs. Cette approche pourrait également être appliquée à votre étude pour développer un jeu interactif adapté aux besoins des patients atteints d'ostéoporose.\n4. Résultats de recherche : Plusieurs études ont évalué l'efficacité de Re-Mission et ont montré que les joueurs qui ont utilisé le jeu ont amélioré leur compréhension de leur maladie, leur adhésion au traitement et leur autogestion. Ces résultats pourraient vous aider à comprendre les mécanismes par lesquels les jeux sérieux peuvent améliorer les résultats en matière de santé et d'éducation des patients.\n\nEn analysant Re-Mission et d'autres jeux sérieux similaires, vous pouvez tirer des enseignements importants sur la manière de concevoir et de développer un jeu interactif efficace pour les patients atteints d'ostéoporose dans le cadre de l'éducation thérapeutique du patient."
         },
         {
            "from": "human",
            "value": "Donne moi des études ayant évalué l'efficacité de Re-Mission"
         },
         {
            "from": "gpt",
            "value": "Voici quelques études qui ont évalué l'efficacité de Re-Mission en tant que jeu sérieux pour les adolescents et les jeunes adultes atteints de cancer :\n\n1. Kato, P. M., Cole, S. W., Bradlyn, A. S., & Pollock, B. H. (2008). A video game improves behavioral outcomes in adolescents and young adults with cancer: A randomized trial. Pediatrics, 122(2), e305-e317.\n\nCette étude randomisée a évalué l'efficacité de Re-Mission sur 375 patients atteints de cancer âgés de 13 à 29 ans. Les résultats ont montré que les participants qui ont joué à Re-Mission ont présenté une meilleure adhésion au traitement, une meilleure connaissance de leur maladie et une augmentation de l'auto-efficacité par rapport au groupe témoin. Les auteurs concluent que Re-Mission peut améliorer les résultats comportementaux et psychosociaux chez les adolescents et les jeunes adultes atteints de cancer.\n\n1. Beale, I. L., Kato, P. M., Marin-Bowling, V. M., Guthrie, N., & Cole, S. W. (2007). Improvement in cancer-related knowledge following use of a psychoeducational video game for adolescents and young adults with cancer. Journal of Adolescent Health, 41(3), 263-270.\n\nCette étude a examiné l'impact de Re-Mission sur la connaissance du cancer et de son traitement chez 200 patients atteints de cancer âgés de 13 à 40 ans. Les résultats ont montré que les participants qui ont joué à Re-Mission ont significativement amélioré leur connaissance du cancer et des traitements par rapport au groupe témoin. Les auteurs suggèrent que Re-Mission peut être un outil efficace pour l'éducation des patients atteints de cancer.\n\n1. Kato, P. M., & Beale, I. L. (2006). Factors affecting acceptability to young cancer patients of a psychoeducational video game about cancer. Journal of Pediatric Oncology Nursing, 23(5), 269-275.\n\nCette étude a exploré les facteurs qui influencent l'acceptabilité de Re-Mission chez 22 patients atteints de cancer âgés de 13 à 34 ans. Les résultats ont montré que les participants ont trouvé Re-Mission engageant, informatif et utile pour les aider à comprendre leur maladie et les traitements. Les auteurs concluent que Re-Mission est un outil psychoéducatif acceptable pour les adolescents et les jeunes adultes atteints de cancer.\n\nCes études montrent que Re-Mission a été efficace pour améliorer la connaissance du cancer, l'adhésion au traitement et l'auto-efficacité chez les adolescents et les jeunes adultes atteints de cancer. L'analyse de ces études peut vous fournir des informations précieuses sur la manière dont un jeu sérieux peut être développé et évalué pour soutenir l'éducation thérapeutique des patients atteints d'ostéoporose."
         }
                       '''], return_tensors='pt')



if __name__ == "__main__":
    res = model.inference(
        inputs=inputs['input_ids'].to("cuda:0"), 
        attention_mask=inputs['attention_mask'].to("cuda:0"),
        use_accelerator=True,
        max_new_tokens=64
    )

    print(torch.cuda.memory_summary(device=0, abbreviated=False))
    print(torch.cuda.memory_allocated(device=0))
    print(model.decode(res))


